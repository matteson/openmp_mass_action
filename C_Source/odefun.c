/*
 *  odefun.c
 *  cvode_test
 *
 *  Created by Andrew Matteson on 1/31/11.
 *  Copyright 2011 __MyCompanyName__. All rights reserved.
 *
 */

/*#include <stdio.h>*/
#include <stdlib.h>
#include <string.h>


/* Header files with a description of contents used */

#include <cvode/cvode.h>             /* prototypes for CVODE fcts., consts. */
#include <cvode/cvode_spgmr.h>        /* prototypes & constants for CVSPGMR */
#include <nvector/nvector_serial.h>  /* serial N_Vector types, fcts., macros */
/*#include <cvode/cvode_dense.h> */      /* prototype for CVDense */
/*#include <sundials/sundials_dense.h>*/ /* definitions DlsMat DENSE_ELEM */
#include <sundials/sundials_types.h> /* definition of type realtype */
#include "UserMacros.c"


#define NEQ 85      /* number of equations  */
#define NUMOUT 81
#define NUMPARAM 118

typedef struct {
realtype spJ[458];
N_Vector J_diag;

realtype kf1;
realtype kf2;
realtype kf3;
realtype kr3;
realtype kf4;
realtype kr4;
realtype kf5;
realtype kf6;
realtype kr6;
realtype kf7;
realtype kf8;
realtype kr8;
realtype kf9;
realtype kr9;
realtype kf10;
realtype kf11;
realtype kr11;
realtype kf12;
realtype kf23;
realtype kf25;
realtype kf27;
realtype kf29;
realtype kf31;
realtype kr31;
realtype kf33;
realtype kr33;
realtype kf35;
realtype kf37;
realtype kf39;
realtype kr39;
realtype kf41;
realtype kr41;
realtype kf43;
realtype kr43;
realtype kf45;
realtype kr45;
realtype kf47;
realtype kr47;
realtype kf49;
realtype kr49;
realtype kf51;
realtype kf55;
realtype kf57;
realtype kf58;
realtype kf59;
realtype kf60;
realtype kf61;
realtype kf62;
realtype kr62;
realtype kf68;
realtype kf69;
realtype kr69;
realtype kf75;
realtype kr76;
realtype kf79;
realtype kf82;
realtype kr83;
realtype kf87;
realtype kr87;
realtype kf88;
realtype kf89;
realtype kr89;
realtype kf90;
realtype kf107;
realtype kr107;
realtype kf108;
realtype kf111;
realtype kr111;
realtype kf112;
realtype kf113;
realtype kr113;
realtype kf114;
realtype kf115;
realtype kf116;
realtype kf117;
realtype kr117;
realtype kf118;
realtype kf119;
realtype kf120;
realtype kr120;
realtype kf121;
realtype kr121;
realtype kf122;
realtype kr122;
realtype kf124;
realtype kr124;
realtype kf126;
realtype kr126;
realtype kf128;
realtype kr128;
realtype kf91;
realtype kr91;
realtype kf92;
realtype kf93;
realtype kr93;
realtype kf94;
realtype kf95;
realtype kr95;
realtype kf96;
realtype kf97;
realtype kr97;
realtype kf98;
realtype kf99;
realtype kr99;
realtype kf100;
realtype kf101;
realtype kf102;
realtype kf103;
realtype kf65_E;
realtype kf65_M;
realtype kf72_M;
realtype kf72_E;
realtype kf83_M;
realtype kf83_E;
realtype kf76_M;
realtype kf76_E;
realtype kf85_M;
realtype kf85_E;

} UserData;

static void staticJac(UserData* data)
{
	realtype *spJ = &(data->spJ[0]);
	memset(spJ, '\0', sizeof(data->spJ));

spJ[0] =  + data->kf1; 
spJ[3] =  + data->kr8; 
spJ[4] =  + data->kf2; 
spJ[7] =  + data->kr3; 
spJ[10] =  - data->kr3 - data->kf4 - data->kf4 - data->kf4 - data->kf4 - data->kf122; 
spJ[11] =  + data->kr4 + data->kr4; 
spJ[12] =  + data->kr122; 
spJ[13] =  + data->kf4 + data->kf4; 
spJ[14] =  - data->kr4 - data->kf5 - data->kf122; 
spJ[15] =  + data->kf7; 
spJ[16] =  + data->kr122; 
spJ[17] =  + data->kf5; 
spJ[20] =  + data->kr6; 
spJ[21] =  + data->kr124; 
spJ[23] =  + data->kr31 + data->kf35; 
spJ[33] =  + data->kr6 + data->kf7; 
spJ[35] =  + data->kr11 + data->kf12; 
spJ[37] =  + data->kr6 + data->kf7; 
spJ[39] =  + data->kf12; 
spJ[42] =  - data->kr6 - data->kf7 - data->kf124; 
spJ[43] =  + data->kr124; 
spJ[46] =  - data->kr8 - data->kf9 - data->kf9 - data->kf9 - data->kf9 - data->kf126; 
spJ[47] =  + data->kr9 + data->kr9; 
spJ[48] =  + data->kr126; 
spJ[49] =  + data->kf9 + data->kf9; 
spJ[50] =  - data->kr9 - data->kf10 - data->kf126; 
spJ[51] =  + data->kf12; 
spJ[52] =  + data->kr126; 
spJ[54] =  + data->kf10; 
spJ[56] =  + data->kr11; 
spJ[57] =  + data->kr128; 
spJ[59] =  + data->kr33 + data->kf37; 
spJ[66] =  - data->kr11 - data->kf12 - data->kf128; 
spJ[67] =  + data->kr128; 
spJ[68] =  + data->kf122; 
spJ[69] =  - data->kf4 - data->kf4 - data->kf4 - data->kf4 - data->kf23 - data->kr122; 
spJ[70] =  + data->kr4 + data->kr4; 
spJ[71] =  + data->kf122; 
spJ[72] =  + data->kf4 + data->kf4; 
spJ[73] =  - data->kr4 - data->kf5 - data->kf23 - data->kr122; 
spJ[74] =  + data->kf7; 
spJ[75] =  + data->kf124; 
spJ[77] =  + data->kf5; 
spJ[79] =  + data->kr6; 
spJ[81] =  + data->kr31 + data->kf35; 
spJ[90] =  + data->kf124; 
spJ[92] =  - data->kr6 - data->kf7 - data->kf25 - data->kr124; 
spJ[93] =  + data->kf126; 
spJ[94] =  - data->kf9 - data->kf9 - data->kf9 - data->kf9 - data->kf27 - data->kr126; 
spJ[95] =  + data->kr9 + data->kr9; 
spJ[96] =  + data->kf126; 
spJ[97] =  + data->kf9 + data->kf9; 
spJ[98] =  - data->kr9 - data->kf10 - data->kf27 - data->kr126; 
spJ[99] =  + data->kf12; 
spJ[101] =  + data->kf128; 
spJ[102] =  + data->kf10; 
spJ[105] =  + data->kr33 + data->kf37; 
spJ[111] =  + data->kf128; 
spJ[113] =  - data->kf12 - data->kf29 - data->kr128; 
spJ[114] =  + data->kf23; 
spJ[115] =  + data->kf23; 
spJ[116] =  + data->kf25; 
spJ[117] =  + data->kf25; 
spJ[118] =  + data->kf27; 
spJ[119] =  + data->kf27; 
spJ[120] =  + data->kf29; 
spJ[121] =  + data->kf29; 
spJ[122] =  + data->kf25; 
spJ[123] =  + data->kf29; 
spJ[124] =  + data->kf25; 
spJ[125] =  + data->kf29; 
spJ[131] =  + data->kr31; 
spJ[132] =  + data->kr31; 
spJ[133] =  + data->kr33; 
spJ[134] =  + data->kr33; 
spJ[135] =  + data->kf57; 
spJ[136] =  + data->kf58; 
spJ[138] =  + data->kr111; 
spJ[139] =  + data->kf115; 
spJ[142] =  - data->kr31 - data->kf35 - data->kf124; 
spJ[143] =  + data->kr124; 
spJ[146] =  + data->kf124; 
spJ[147] =  - data->kf25 - data->kr31 - data->kf35 - data->kr124; 
spJ[150] =  - data->kr33 - data->kf37 - data->kf128; 
spJ[151] =  + data->kr128; 
spJ[154] =  + data->kf128; 
spJ[155] =  - data->kf29 - data->kr33 - data->kf37 - data->kr128; 
spJ[156] =  + data->kf35; 
spJ[157] =  + data->kf35; 
spJ[160] =  + data->kr83 + data->kf85_M; 
spJ[161] =  + data->kf37; 
spJ[162] =  + data->kf37; 
spJ[165] =  + data->kr83 + data->kf85_E; 
spJ[171] =  + data->kr39; 
spJ[172] =  + data->kr39; 
spJ[173] =  + data->kf116; 
spJ[174] =  + data->kr43; 
spJ[175] =  + data->kr43; 
spJ[176] =  + data->kr120; 
spJ[178] =  + data->kf59; 
spJ[179] =  + data->kf61; 
spJ[181] =  + data->kr113; 
spJ[195] =  + data->kr41; 
spJ[196] =  + data->kr41; 
spJ[198] =  + data->kr121; 
spJ[199] =  + data->kf60; 
spJ[200] =  + data->kf114; 
spJ[214] =  + data->kr128; 
spJ[219] =  + data->kf128; 
spJ[249] =  + data->kf118; 
spJ[257] =  + data->kf51; 
spJ[258] =  + data->kf51; 
spJ[261] =  + data->kr62 + data->kf65_M; 
spJ[263] =  + data->kr69 + data->kf72_M; 
spJ[265] =  + data->kr76 + data->kf79; 
spJ[266] =  + data->kf51; 
spJ[267] =  + data->kf51; 
spJ[270] =  + data->kr62 + data->kf65_M; 
spJ[272] =  + data->kr69 + data->kf72_M; 
spJ[274] =  + data->kr76 + data->kf79; 
spJ[275] =  + data->kf55; 
spJ[276] =  + data->kf55; 
spJ[279] =  + data->kr62 + data->kf65_E; 
spJ[281] =  + data->kr69 + data->kf72_E; 
spJ[283] =  + data->kr76 + data->kf79; 
spJ[288] =  + data->kr62; 
spJ[289] =  + data->kr62; 
spJ[290] =  + data->kr62; 
spJ[291] =  + data->kf68; 
spJ[292] =  + data->kf88; 
spJ[295] =  - data->kr62 - data->kf65_M; 
spJ[298] =  - data->kr62 - data->kf65_M; 
spJ[301] =  - data->kr62 - data->kf65_E; 
spJ[302] =  + data->kf65_M; 
spJ[303] =  + data->kf65_M; 
spJ[304] =  + data->kf65_E; 
spJ[308] =  + data->kr87; 
spJ[309] =  + data->kr89 + data->kf90; 
spJ[314] =  + data->kr69; 
spJ[315] =  + data->kr69; 
spJ[316] =  + data->kr69; 
spJ[317] =  + data->kf75; 
spJ[320] =  - data->kr69 - data->kf72_M; 
spJ[323] =  - data->kr69 - data->kf72_M; 
spJ[326] =  - data->kr69 - data->kf72_E; 
spJ[328] =  + data->kf72_M; 
spJ[329] =  + data->kf72_M; 
spJ[330] =  + data->kf72_E; 
spJ[332] =  + data->kr87 + data->kf88; 
spJ[337] =  + data->kr76; 
spJ[338] =  + data->kr76; 
spJ[339] =  + data->kr76; 
spJ[340] =  + data->kf82; 
spJ[343] =  - data->kr76 - data->kf79; 
spJ[346] =  - data->kr76 - data->kf79; 
spJ[349] =  - data->kr76 - data->kf79; 
spJ[350] =  + data->kf79; 
spJ[351] =  + data->kf79; 
spJ[352] =  + data->kf79; 
spJ[355] =  + data->kr117 + data->kf118; 
spJ[359] =  + data->kr83; 
spJ[360] =  + data->kr83; 
spJ[361] =  + data->kf90; 
spJ[364] =  - data->kr83 - data->kf85_M; 
spJ[367] =  - data->kr83 - data->kf85_E; 
spJ[369] =  + data->kf85_M; 
spJ[370] =  + data->kf85_E; 
spJ[372] =  + data->kr89; 
spJ[374] =  + data->kr91 + data->kf92; 
spJ[377] =  - data->kr87 - data->kf88; 
spJ[380] =  - data->kr89 - data->kf90; 
spJ[382] =  + data->kf108; 
spJ[384] =  + data->kr97; 
spJ[389] =  + data->kr107; 
spJ[390] =  + data->kr111 + data->kf112; 
spJ[391] =  + data->kr113 + data->kf114; 
spJ[392] =  + data->kf100; 
spJ[395] =  + data->kr107 + data->kf108; 
spJ[398] =  - data->kr107 - data->kf108; 
spJ[401] =  - data->kr111 - data->kf112; 
spJ[402] =  + data->kf112; 
spJ[403] =  - data->kf115; 
spJ[406] =  - data->kr113 - data->kf114; 
spJ[407] =  + data->kf119; 
spJ[410] =  + data->kr117; 
spJ[413] =  - data->kr117 - data->kf118; 
spJ[416] =  + data->kr91; 
spJ[417] =  + data->kf101; 
spJ[420] =  - data->kr91 - data->kf92; 
spJ[421] =  + data->kf92; 
spJ[424] =  + data->kr93 + data->kf94; 
spJ[426] =  + data->kr95 + data->kf96; 
spJ[429] =  + data->kr93; 
spJ[430] =  + data->kf103; 
spJ[433] =  - data->kr93 - data->kf94; 
spJ[435] =  + data->kf94; 
spJ[437] =  + data->kr95; 
spJ[438] =  + data->kf102; 
spJ[441] =  - data->kr95 - data->kf96; 
spJ[443] =  + data->kf96; 
spJ[445] =  + data->kr97 + data->kf98; 
spJ[447] =  + data->kr99 + data->kf100; 
spJ[450] =  - data->kr97 - data->kf98; 
spJ[452] =  + data->kf98; 
spJ[454] =  + data->kr99; 
spJ[457] =  - data->kr99 - data->kf100; 
}

static void updateJac(UserData* data,N_Vector y)
{
realtype kf1, kf2, kf3, kr3, kf4, kr4, kf5, kf6, kr6, kf7, kf8, kr8, kf9, kr9, kf10, kf11, kr11, kf12, kf23, kf25, kf27, kf29, kf31, kr31, kf33, kr33, kf35, kf37, kf39, kr39, kf41, kr41, kf43, kr43, kf45, kr45, kf47, kr47, kf49, kr49, kf51, kf55, kf57, kf58, kf59, kf60, kf61, kf62, kr62, kf68, kf69, kr69, kf75, kr76, kf79, kf82, kr83, kf87, kr87, kf88, kf89, kr89, kf90, kf107, kr107, kf108, kf111, kr111, kf112, kf113, kr113, kf114, kf115, kf116, kf117, kr117, kf118, kf119, kf120, kr120, kf121, kr121, kf122, kr122, kf124, kr124, kf126, kr126, kf128, kr128, kf91, kr91, kf92, kf93, kr93, kf94, kf95, kr95, kf96, kf97, kr97, kf98, kf99, kr99, kf100, kf101, kf102, kf103, kf65_E, kf65_M, kf72_M, kf72_E, kf83_M, kf83_E, kf76_M, kf76_E, kf85_M, kf85_E; 
 
kf1 = data->kf1;
kf2 = data->kf2;
kf3 = data->kf3;
kr3 = data->kr3;
kf4 = data->kf4;
kr4 = data->kr4;
kf5 = data->kf5;
kf6 = data->kf6;
kr6 = data->kr6;
kf7 = data->kf7;
kf8 = data->kf8;
kr8 = data->kr8;
kf9 = data->kf9;
kr9 = data->kr9;
kf10 = data->kf10;
kf11 = data->kf11;
kr11 = data->kr11;
kf12 = data->kf12;
kf23 = data->kf23;
kf25 = data->kf25;
kf27 = data->kf27;
kf29 = data->kf29;
kf31 = data->kf31;
kr31 = data->kr31;
kf33 = data->kf33;
kr33 = data->kr33;
kf35 = data->kf35;
kf37 = data->kf37;
kf39 = data->kf39;
kr39 = data->kr39;
kf41 = data->kf41;
kr41 = data->kr41;
kf43 = data->kf43;
kr43 = data->kr43;
kf45 = data->kf45;
kr45 = data->kr45;
kf47 = data->kf47;
kr47 = data->kr47;
kf49 = data->kf49;
kr49 = data->kr49;
kf51 = data->kf51;
kf55 = data->kf55;
kf57 = data->kf57;
kf58 = data->kf58;
kf59 = data->kf59;
kf60 = data->kf60;
kf61 = data->kf61;
kf62 = data->kf62;
kr62 = data->kr62;
kf68 = data->kf68;
kf69 = data->kf69;
kr69 = data->kr69;
kf75 = data->kf75;
kr76 = data->kr76;
kf79 = data->kf79;
kf82 = data->kf82;
kr83 = data->kr83;
kf87 = data->kf87;
kr87 = data->kr87;
kf88 = data->kf88;
kf89 = data->kf89;
kr89 = data->kr89;
kf90 = data->kf90;
kf107 = data->kf107;
kr107 = data->kr107;
kf108 = data->kf108;
kf111 = data->kf111;
kr111 = data->kr111;
kf112 = data->kf112;
kf113 = data->kf113;
kr113 = data->kr113;
kf114 = data->kf114;
kf115 = data->kf115;
kf116 = data->kf116;
kf117 = data->kf117;
kr117 = data->kr117;
kf118 = data->kf118;
kf119 = data->kf119;
kf120 = data->kf120;
kr120 = data->kr120;
kf121 = data->kf121;
kr121 = data->kr121;
kf122 = data->kf122;
kr122 = data->kr122;
kf124 = data->kf124;
kr124 = data->kr124;
kf126 = data->kf126;
kr126 = data->kr126;
kf128 = data->kf128;
kr128 = data->kr128;
kf91 = data->kf91;
kr91 = data->kr91;
kf92 = data->kf92;
kf93 = data->kf93;
kr93 = data->kr93;
kf94 = data->kf94;
kf95 = data->kf95;
kr95 = data->kr95;
kf96 = data->kf96;
kf97 = data->kf97;
kr97 = data->kr97;
kf98 = data->kf98;
kf99 = data->kf99;
kr99 = data->kr99;
kf100 = data->kf100;
kf101 = data->kf101;
kf102 = data->kf102;
kf103 = data->kf103;
kf65_E = data->kf65_E;
kf65_M = data->kf65_M;
kf72_M = data->kf72_M;
kf72_E = data->kf72_E;
kf83_M = data->kf83_M;
kf83_E = data->kf83_E;
kf76_M = data->kf76_M;
kf76_E = data->kf76_E;
kf85_M = data->kf85_M;
kf85_E = data->kf85_E;

realtype *y_data = NV_DATA_S(y);

realtype *spJ = &(data->spJ[0]);

spJ[1] =  - kf8*y_data[9]; 
spJ[2] =  - kf8*y_data[1]; 
spJ[5] =  - kf3*y_data[3]; 
spJ[6] =  - kf3*y_data[2]; 
spJ[8] =  + kf3*y_data[3]; 
spJ[9] =  + kf3*y_data[2]; 
spJ[18] =  - kf6*y_data[7] - kf31*y_data[23] - kf39*y_data[30] - kf41*y_data[33] - kf45*y_data[38] - kf47*y_data[40] - kf124; 
spJ[19] =  - kf6*y_data[6]; 
spJ[22] =  - kf31*y_data[6]; 
spJ[24] =  - kf39*y_data[6]; 
spJ[25] =  + kr39 + kr45*y_data[39] + kf51; 
spJ[26] =  - kf41*y_data[6]; 
spJ[27] =  + kr41 + kr47*y_data[39] + kf51; 
spJ[28] =  - kf45*y_data[6]; 
spJ[29] =  + kr45*y_data[31] + kr47*y_data[34]; 
spJ[30] =  - kf47*y_data[6]; 
spJ[31] =  - kf6*y_data[7]; 
spJ[32] =  - kf6*y_data[6] - kf11*y_data[12] - kf6*y_data[16] - kf11*y_data[20]; 
spJ[34] =  - kf11*y_data[7]; 
spJ[36] =  - kf6*y_data[7]; 
spJ[38] =  - kf11*y_data[7]; 
spJ[40] =  + kf6*y_data[7]; 
spJ[41] =  + kf6*y_data[6]; 
spJ[44] =  + kf8*y_data[9]; 
spJ[45] =  + kf8*y_data[1]; 
spJ[53] =  - kf11*y_data[12]; 
spJ[55] =  - kf11*y_data[7] - kf33*y_data[23] - kf43*y_data[30] - kf49*y_data[38] - kf128; 
spJ[58] =  - kf33*y_data[12]; 
spJ[60] =  - kf43*y_data[12]; 
spJ[61] =  + kr43 + kr49*y_data[39] + kf55; 
spJ[62] =  - kf49*y_data[12]; 
spJ[63] =  + kr49*y_data[36]; 
spJ[64] =  + kf11*y_data[12]; 
spJ[65] =  + kf11*y_data[7]; 
spJ[76] =  - kf6*y_data[16]; 
spJ[78] =  - kf6*y_data[7] - kf25 - kf31*y_data[23] - kf39*y_data[30] - kf41*y_data[33] - kf45*y_data[38] - kf47*y_data[40] - kr124; 
spJ[80] =  - kf31*y_data[16]; 
spJ[82] =  - kf39*y_data[16]; 
spJ[83] =  + kr39 + kr45*y_data[39] + kf51; 
spJ[84] =  - kf41*y_data[16]; 
spJ[85] =  + kr41 + kr47*y_data[39] + kf51; 
spJ[86] =  - kf45*y_data[16]; 
spJ[87] =  + kr45*y_data[32] + kr47*y_data[35]; 
spJ[88] =  - kf47*y_data[16]; 
spJ[89] =  + kf6*y_data[16]; 
spJ[91] =  + kf6*y_data[7]; 
spJ[100] =  - kf11*y_data[20]; 
spJ[103] =  - kf11*y_data[7] - kf29 - kf33*y_data[23] - kf43*y_data[30] - kf49*y_data[38] - kr128; 
spJ[104] =  - kf33*y_data[20]; 
spJ[106] =  - kf43*y_data[20]; 
spJ[107] =  + kr43 + kr49*y_data[39] + kf55; 
spJ[108] =  - kf49*y_data[20]; 
spJ[109] =  + kr49*y_data[37]; 
spJ[110] =  + kf11*y_data[20]; 
spJ[112] =  + kf11*y_data[7]; 
spJ[126] =  - kf31*y_data[23]; 
spJ[127] =  - kf33*y_data[23]; 
spJ[128] =  - kf31*y_data[23]; 
spJ[129] =  - kf33*y_data[23]; 
spJ[130] =  - kf31*y_data[6] - kf31*y_data[16] - kf33*y_data[12] - kf33*y_data[20] - kf111*y_data[66]; 
spJ[137] =  - kf111*y_data[23]; 
spJ[140] =  + kf31*y_data[23]; 
spJ[141] =  + kf31*y_data[6]; 
spJ[144] =  + kf31*y_data[23]; 
spJ[145] =  + kf31*y_data[16]; 
spJ[148] =  + kf33*y_data[23]; 
spJ[149] =  + kf33*y_data[12]; 
spJ[152] =  + kf33*y_data[23]; 
spJ[153] =  + kf33*y_data[20]; 
spJ[158] =  - kf57 - kf83_M*y_data[59]; 
spJ[159] =  - kf83_M*y_data[28]; 
spJ[163] =  - kf58 - kf83_E*y_data[59]; 
spJ[164] =  - kf83_E*y_data[29]; 
spJ[166] =  - kf39*y_data[30]; 
spJ[167] =  - kf43*y_data[30]; 
spJ[168] =  - kf39*y_data[30]; 
spJ[169] =  - kf43*y_data[30]; 
spJ[170] =  - kf39*y_data[6] - kf39*y_data[16] - kf43*y_data[12] - kf43*y_data[20] - kf113*y_data[66] - kf120*y_data[39]; 
spJ[177] =  - kf120*y_data[30]; 
spJ[180] =  - kf113*y_data[30]; 
spJ[182] =  + kf39*y_data[30] + kf45*y_data[38]; 
spJ[183] =  + kf39*y_data[6]; 
spJ[184] =  - kr39 - kr45*y_data[39] - kf51; 
spJ[185] =  + kf45*y_data[6]; 
spJ[186] =  - kr45*y_data[31]; 
spJ[187] =  + kf39*y_data[30] + kf45*y_data[38]; 
spJ[188] =  + kf39*y_data[16]; 
spJ[189] =  - kf25 - kr39 - kr45*y_data[39] - kf51; 
spJ[190] =  + kf45*y_data[16]; 
spJ[191] =  - kr45*y_data[32]; 
spJ[192] =  - kf41*y_data[33]; 
spJ[193] =  - kf41*y_data[33]; 
spJ[194] =  - kf41*y_data[6] - kf41*y_data[16] - kf116 - kf121*y_data[39]; 
spJ[197] =  - kf121*y_data[33]; 
spJ[201] =  + kf41*y_data[33] + kf47*y_data[40]; 
spJ[202] =  + kf41*y_data[6]; 
spJ[203] =  - kr41 - kr47*y_data[39] - kf51; 
spJ[204] =  - kr47*y_data[34]; 
spJ[205] =  + kf47*y_data[6]; 
spJ[206] =  + kf41*y_data[33] + kf47*y_data[40]; 
spJ[207] =  + kf41*y_data[16]; 
spJ[208] =  - kr41 - kr47*y_data[39] - kf51; 
spJ[209] =  - kr47*y_data[35]; 
spJ[210] =  + kf47*y_data[16]; 
spJ[211] =  + kf43*y_data[30] + kf49*y_data[38]; 
spJ[212] =  + kf43*y_data[12]; 
spJ[213] =  - kr43 - kr49*y_data[39] - kf55 - kf128; 
spJ[215] =  + kf49*y_data[12]; 
spJ[216] =  - kr49*y_data[36]; 
spJ[217] =  + kf43*y_data[30] + kf49*y_data[38]; 
spJ[218] =  + kf43*y_data[20]; 
spJ[220] =  - kf29 - kr43 - kr49*y_data[39] - kf55 - kr128; 
spJ[221] =  + kf49*y_data[20]; 
spJ[222] =  - kr49*y_data[37]; 
spJ[223] =  - kf45*y_data[38]; 
spJ[224] =  - kf49*y_data[38]; 
spJ[225] =  - kf45*y_data[38]; 
spJ[226] =  - kf49*y_data[38]; 
spJ[227] =  + kf120*y_data[39]; 
spJ[228] =  + kr45*y_data[39]; 
spJ[229] =  + kr45*y_data[39]; 
spJ[230] =  + kr49*y_data[39]; 
spJ[231] =  + kr49*y_data[39]; 
spJ[232] =  - kf45*y_data[6] - kf45*y_data[16] - kf49*y_data[12] - kf49*y_data[20] - kr120; 
spJ[233] =  + kr45*y_data[31] + kr45*y_data[32] + kr49*y_data[36] + kr49*y_data[37] + kf120*y_data[30]; 
spJ[234] =  + kf45*y_data[38] + kf47*y_data[40]; 
spJ[235] =  + kf49*y_data[38]; 
spJ[236] =  + kf45*y_data[38] + kf47*y_data[40]; 
spJ[237] =  + kf49*y_data[38]; 
spJ[238] =  - kf120*y_data[39]; 
spJ[239] =  - kr45*y_data[39]; 
spJ[240] =  - kr45*y_data[39]; 
spJ[241] =  - kf121*y_data[39]; 
spJ[242] =  - kr47*y_data[39]; 
spJ[243] =  - kr47*y_data[39]; 
spJ[244] =  - kr49*y_data[39]; 
spJ[245] =  - kr49*y_data[39]; 
spJ[246] =  + kf45*y_data[6] + kf45*y_data[16] + kf49*y_data[12] + kf49*y_data[20] + kr120; 
spJ[247] =  - kr45*y_data[31] - kr45*y_data[32] - kr47*y_data[34] - kr47*y_data[35] - kr49*y_data[36] - kr49*y_data[37] - kf119 - kf120*y_data[30] - kf121*y_data[33]; 
spJ[248] =  + kf47*y_data[6] + kf47*y_data[16] + kr121; 
spJ[250] =  - kf47*y_data[40]; 
spJ[251] =  - kf47*y_data[40]; 
spJ[252] =  + kf121*y_data[39]; 
spJ[253] =  + kr47*y_data[39]; 
spJ[254] =  + kr47*y_data[39]; 
spJ[255] =  + kr47*y_data[34] + kr47*y_data[35] + kf121*y_data[33]; 
spJ[256] =  - kf47*y_data[6] - kf47*y_data[16] - kr121; 
spJ[259] =  - kf59 - kf62*y_data[44] - kf69*y_data[49] - kf76_M*y_data[54]; 
spJ[260] =  - kf62*y_data[41]; 
spJ[262] =  - kf69*y_data[41]; 
spJ[264] =  - kf76_M*y_data[41]; 
spJ[268] =  - kf60 - kf62*y_data[44] - kf69*y_data[49] - kf76_M*y_data[54]; 
spJ[269] =  - kf62*y_data[42]; 
spJ[271] =  - kf69*y_data[42]; 
spJ[273] =  - kf76_M*y_data[42]; 
spJ[277] =  - kf61 - kf62*y_data[44] - kf69*y_data[49] - kf76_E*y_data[54]; 
spJ[278] =  - kf62*y_data[43]; 
spJ[280] =  - kf69*y_data[43]; 
spJ[282] =  - kf76_E*y_data[43]; 
spJ[284] =  - kf62*y_data[44]; 
spJ[285] =  - kf62*y_data[44]; 
spJ[286] =  - kf62*y_data[44]; 
spJ[287] =  - kf62*y_data[41] - kf62*y_data[42] - kf62*y_data[43]; 
spJ[293] =  + kf62*y_data[44]; 
spJ[294] =  + kf62*y_data[41]; 
spJ[296] =  + kf62*y_data[44]; 
spJ[297] =  + kf62*y_data[42]; 
spJ[299] =  + kf62*y_data[44]; 
spJ[300] =  + kf62*y_data[43]; 
spJ[305] =  - kf68 - kf87*y_data[53] - kf89*y_data[62]; 
spJ[306] =  - kf87*y_data[48]; 
spJ[307] =  - kf89*y_data[48]; 
spJ[310] =  - kf69*y_data[49]; 
spJ[311] =  - kf69*y_data[49]; 
spJ[312] =  - kf69*y_data[49]; 
spJ[313] =  - kf69*y_data[41] - kf69*y_data[42] - kf69*y_data[43]; 
spJ[318] =  + kf69*y_data[49]; 
spJ[319] =  + kf69*y_data[41]; 
spJ[321] =  + kf69*y_data[49]; 
spJ[322] =  + kf69*y_data[42]; 
spJ[324] =  + kf69*y_data[49]; 
spJ[325] =  + kf69*y_data[43]; 
spJ[327] =  - kf87*y_data[53]; 
spJ[331] =  - kf75 - kf87*y_data[48]; 
spJ[333] =  - kf76_M*y_data[54]; 
spJ[334] =  - kf76_M*y_data[54]; 
spJ[335] =  - kf76_E*y_data[54]; 
spJ[336] =  - kf76_M*y_data[41] - kf76_M*y_data[42] - kf76_E*y_data[43]; 
spJ[341] =  + kf76_M*y_data[54]; 
spJ[342] =  + kf76_M*y_data[41]; 
spJ[344] =  + kf76_M*y_data[54]; 
spJ[345] =  + kf76_M*y_data[42]; 
spJ[347] =  + kf76_E*y_data[54]; 
spJ[348] =  + kf76_E*y_data[43]; 
spJ[353] =  - kf82 - kf117*y_data[72]; 
spJ[354] =  - kf117*y_data[58]; 
spJ[356] =  - kf83_M*y_data[59]; 
spJ[357] =  - kf83_E*y_data[59]; 
spJ[358] =  - kf83_M*y_data[28] - kf83_E*y_data[29]; 
spJ[362] =  + kf83_M*y_data[59]; 
spJ[363] =  + kf83_M*y_data[28]; 
spJ[365] =  + kf83_E*y_data[59]; 
spJ[366] =  + kf83_E*y_data[29]; 
spJ[368] =  - kf89*y_data[62]; 
spJ[371] =  - kf89*y_data[48] - kf91*y_data[74]; 
spJ[373] =  - kf91*y_data[62]; 
spJ[375] =  + kf87*y_data[53]; 
spJ[376] =  + kf87*y_data[48]; 
spJ[378] =  + kf89*y_data[62]; 
spJ[379] =  + kf89*y_data[48]; 
spJ[381] =  - kf97*y_data[81]; 
spJ[383] =  - kf97*y_data[65]; 
spJ[385] =  - kf111*y_data[66]; 
spJ[386] =  - kf113*y_data[66]; 
spJ[387] =  - kf107*y_data[67] - kf111*y_data[23] - kf113*y_data[30]; 
spJ[388] =  - kf107*y_data[66]; 
spJ[393] =  - kf107*y_data[67]; 
spJ[394] =  - kf107*y_data[66]; 
spJ[396] =  + kf107*y_data[67]; 
spJ[397] =  + kf107*y_data[66]; 
spJ[399] =  + kf111*y_data[66]; 
spJ[400] =  + kf111*y_data[23]; 
spJ[404] =  + kf113*y_data[66]; 
spJ[405] =  + kf113*y_data[30]; 
spJ[408] =  - kf117*y_data[72]; 
spJ[409] =  - kf117*y_data[58]; 
spJ[411] =  + kf117*y_data[72]; 
spJ[412] =  + kf117*y_data[58]; 
spJ[414] =  - kf91*y_data[74]; 
spJ[415] =  - kf91*y_data[62]; 
spJ[418] =  + kf91*y_data[74]; 
spJ[419] =  + kf91*y_data[62]; 
spJ[422] =  - kf93*y_data[77] - kf95*y_data[79] - kf101; 
spJ[423] =  - kf93*y_data[76]; 
spJ[425] =  - kf95*y_data[76]; 
spJ[427] =  - kf93*y_data[77]; 
spJ[428] =  - kf93*y_data[76]; 
spJ[431] =  + kf93*y_data[77]; 
spJ[432] =  + kf93*y_data[76]; 
spJ[434] =  - kf95*y_data[79]; 
spJ[436] =  - kf95*y_data[76] - kf103; 
spJ[439] =  + kf95*y_data[79]; 
spJ[440] =  + kf95*y_data[76]; 
spJ[442] =  - kf97*y_data[81]; 
spJ[444] =  - kf97*y_data[65] - kf99*y_data[83] - kf102; 
spJ[446] =  - kf99*y_data[81]; 
spJ[448] =  + kf97*y_data[81]; 
spJ[449] =  + kf97*y_data[65]; 
spJ[451] =  - kf99*y_data[83]; 
spJ[453] =  - kf99*y_data[81]; 
spJ[455] =  + kf99*y_data[83]; 
spJ[456] =  + kf99*y_data[81]; 

}

static void parampass(UserData* data, realtype param[])
{
data->kf1 = param[0];
data->kf2 = param[1];
data->kf3 = param[2];
data->kr3 = param[3];
data->kf4 = param[4];
data->kr4 = param[5];
data->kf5 = param[6];
data->kf6 = param[7];
data->kr6 = param[8];
data->kf7 = param[9];
data->kf8 = param[10];
data->kr8 = param[11];
data->kf9 = param[12];
data->kr9 = param[13];
data->kf10 = param[14];
data->kf11 = param[15];
data->kr11 = param[16];
data->kf12 = param[17];
data->kf23 = param[18];
data->kf25 = param[19];
data->kf27 = param[20];
data->kf29 = param[21];
data->kf31 = param[22];
data->kr31 = param[23];
data->kf33 = param[24];
data->kr33 = param[25];
data->kf35 = param[26];
data->kf37 = param[27];
data->kf39 = param[28];
data->kr39 = param[29];
data->kf41 = param[30];
data->kr41 = param[31];
data->kf43 = param[32];
data->kr43 = param[33];
data->kf45 = param[34];
data->kr45 = param[35];
data->kf47 = param[36];
data->kr47 = param[37];
data->kf49 = param[38];
data->kr49 = param[39];
data->kf51 = param[40];
data->kf55 = param[41];
data->kf57 = param[42];
data->kf58 = param[43];
data->kf59 = param[44];
data->kf60 = param[45];
data->kf61 = param[46];
data->kf62 = param[47];
data->kr62 = param[48];
data->kf68 = param[49];
data->kf69 = param[50];
data->kr69 = param[51];
data->kf75 = param[52];
data->kr76 = param[53];
data->kf79 = param[54];
data->kf82 = param[55];
data->kr83 = param[56];
data->kf87 = param[57];
data->kr87 = param[58];
data->kf88 = param[59];
data->kf89 = param[60];
data->kr89 = param[61];
data->kf90 = param[62];
data->kf107 = param[63];
data->kr107 = param[64];
data->kf108 = param[65];
data->kf111 = param[66];
data->kr111 = param[67];
data->kf112 = param[68];
data->kf113 = param[69];
data->kr113 = param[70];
data->kf114 = param[71];
data->kf115 = param[72];
data->kf116 = param[73];
data->kf117 = param[74];
data->kr117 = param[75];
data->kf118 = param[76];
data->kf119 = param[77];
data->kf120 = param[78];
data->kr120 = param[79];
data->kf121 = param[80];
data->kr121 = param[81];
data->kf122 = param[82];
data->kr122 = param[83];
data->kf124 = param[84];
data->kr124 = param[85];
data->kf126 = param[86];
data->kr126 = param[87];
data->kf128 = param[88];
data->kr128 = param[89];
data->kf91 = param[90];
data->kr91 = param[91];
data->kf92 = param[92];
data->kf93 = param[93];
data->kr93 = param[94];
data->kf94 = param[95];
data->kf95 = param[96];
data->kr95 = param[97];
data->kf96 = param[98];
data->kf97 = param[99];
data->kr97 = param[100];
data->kf98 = param[101];
data->kf99 = param[102];
data->kr99 = param[103];
data->kf100 = param[104];
data->kf101 = param[105];
data->kf102 = param[106];
data->kf103 = param[107];
data->kf65_E = param[108];
data->kf65_M = param[109];
data->kf72_M = param[110];
data->kf72_E = param[111];
data->kf83_M = param[112];
data->kf83_E = param[113];
data->kf76_M = param[114];
data->kf76_E = param[115];
data->kf85_M = param[116];
data->kf85_E = param[117];
}

static void setRates(realtype kf_rates[129], realtype kr_rates[60], N_Vector y, UserData* data) 
{ 
realtype kf1, kf2, kf3, kr3, kf4, kr4, kf5, kf6, kr6, kf7, kf8, kr8, kf9, kr9, kf10, kf11, kr11, kf12, kf23, kf25, kf27, kf29, kf31, kr31, kf33, kr33, kf35, kf37, kf39, kr39, kf41, kr41, kf43, kr43, kf45, kr45, kf47, kr47, kf49, kr49, kf51, kf55, kf57, kf58, kf59, kf60, kf61, kf62, kr62, kf68, kf69, kr69, kf75, kr76, kf79, kf82, kr83, kf87, kr87, kf88, kf89, kr89, kf90, kf107, kr107, kf108, kf111, kr111, kf112, kf113, kr113, kf114, kf115, kf116, kf117, kr117, kf118, kf119, kf120, kr120, kf121, kr121, kf122, kr122, kf124, kr124, kf126, kr126, kf128, kr128, kf91, kr91, kf92, kf93, kr93, kf94, kf95, kr95, kf96, kf97, kr97, kf98, kf99, kr99, kf100, kf101, kf102, kf103, kf65_E, kf65_M, kf72_M, kf72_E, kf83_M, kf83_E, kf76_M, kf76_E, kf85_M, kf85_E; 
 
kf1 = data->kf1;
kf2 = data->kf2;
kf3 = data->kf3;
kr3 = data->kr3;
kf4 = data->kf4;
kr4 = data->kr4;
kf5 = data->kf5;
kf6 = data->kf6;
kr6 = data->kr6;
kf7 = data->kf7;
kf8 = data->kf8;
kr8 = data->kr8;
kf9 = data->kf9;
kr9 = data->kr9;
kf10 = data->kf10;
kf11 = data->kf11;
kr11 = data->kr11;
kf12 = data->kf12;
kf23 = data->kf23;
kf25 = data->kf25;
kf27 = data->kf27;
kf29 = data->kf29;
kf31 = data->kf31;
kr31 = data->kr31;
kf33 = data->kf33;
kr33 = data->kr33;
kf35 = data->kf35;
kf37 = data->kf37;
kf39 = data->kf39;
kr39 = data->kr39;
kf41 = data->kf41;
kr41 = data->kr41;
kf43 = data->kf43;
kr43 = data->kr43;
kf45 = data->kf45;
kr45 = data->kr45;
kf47 = data->kf47;
kr47 = data->kr47;
kf49 = data->kf49;
kr49 = data->kr49;
kf51 = data->kf51;
kf55 = data->kf55;
kf57 = data->kf57;
kf58 = data->kf58;
kf59 = data->kf59;
kf60 = data->kf60;
kf61 = data->kf61;
kf62 = data->kf62;
kr62 = data->kr62;
kf68 = data->kf68;
kf69 = data->kf69;
kr69 = data->kr69;
kf75 = data->kf75;
kr76 = data->kr76;
kf79 = data->kf79;
kf82 = data->kf82;
kr83 = data->kr83;
kf87 = data->kf87;
kr87 = data->kr87;
kf88 = data->kf88;
kf89 = data->kf89;
kr89 = data->kr89;
kf90 = data->kf90;
kf107 = data->kf107;
kr107 = data->kr107;
kf108 = data->kf108;
kf111 = data->kf111;
kr111 = data->kr111;
kf112 = data->kf112;
kf113 = data->kf113;
kr113 = data->kr113;
kf114 = data->kf114;
kf115 = data->kf115;
kf116 = data->kf116;
kf117 = data->kf117;
kr117 = data->kr117;
kf118 = data->kf118;
kf119 = data->kf119;
kf120 = data->kf120;
kr120 = data->kr120;
kf121 = data->kf121;
kr121 = data->kr121;
kf122 = data->kf122;
kr122 = data->kr122;
kf124 = data->kf124;
kr124 = data->kr124;
kf126 = data->kf126;
kr126 = data->kr126;
kf128 = data->kf128;
kr128 = data->kr128;
kf91 = data->kf91;
kr91 = data->kr91;
kf92 = data->kf92;
kf93 = data->kf93;
kr93 = data->kr93;
kf94 = data->kf94;
kf95 = data->kf95;
kr95 = data->kr95;
kf96 = data->kf96;
kf97 = data->kf97;
kr97 = data->kr97;
kf98 = data->kf98;
kf99 = data->kf99;
kr99 = data->kr99;
kf100 = data->kf100;
kf101 = data->kf101;
kf102 = data->kf102;
kf103 = data->kf103;
kf65_E = data->kf65_E;
kf65_M = data->kf65_M;
kf72_M = data->kf72_M;
kf72_E = data->kf72_E;
kf83_M = data->kf83_M;
kf83_E = data->kf83_E;
kf76_M = data->kf76_M;
kf76_E = data->kf76_E;
kf85_M = data->kf85_M;
kf85_E = data->kf85_E;


realtype *y_data = NV_DATA_S(y); 

kf_rates[0] = kf1*y_data[0];
kf_rates[1] = kf2*y_data[0];
kf_rates[2] = kf3*y_data[3]*y_data[2];
kr_rates[0] = kr3*y_data[4];
kf_rates[3] = kf4*y_data[4]*y_data[4];
kr_rates[1] = kr4*y_data[5];
kf_rates[4] = kf5*y_data[5];
kf_rates[5] = kf6*y_data[6]*y_data[7];
kr_rates[2] = kr6*y_data[8];
kf_rates[6] = kf7*y_data[8];
kf_rates[7] = kf8*y_data[9]*y_data[1];
kr_rates[3] = kr8*y_data[10];
kf_rates[8] = kf9*y_data[10]*y_data[10];
kr_rates[4] = kr9*y_data[11];
kf_rates[9] = kf10*y_data[11];
kf_rates[10] = kf11*y_data[12]*y_data[7];
kr_rates[5] = kr11*y_data[13];
kf_rates[11] = kf12*y_data[13];
kf_rates[12] = kf4*y_data[14]*y_data[14];
kr_rates[6] = kr4*y_data[15];
kf_rates[13] = kf5*y_data[15];
kf_rates[14] = kf6*y_data[16]*y_data[7];
kr_rates[7] = kr6*y_data[17];
kf_rates[15] = kf7*y_data[17];
kf_rates[16] = kf9*y_data[18]*y_data[18];
kr_rates[8] = kr9*y_data[19];
kf_rates[17] = kf10*y_data[19];
kf_rates[18] = kf11*y_data[20]*y_data[7];
kf_rates[19] = kf12*y_data[21];
kf_rates[20] = kf23*y_data[14];
kf_rates[21] = kf23*y_data[15];
kf_rates[22] = kf25*y_data[16];
kf_rates[23] = kf25*y_data[25];
kf_rates[24] = kf25*y_data[32];
kf_rates[25] = kf25*y_data[17];
kf_rates[26] = kf27*y_data[18];
kf_rates[27] = kf27*y_data[19];
kf_rates[28] = kf29*y_data[20];
kf_rates[29] = kf29*y_data[27];
kf_rates[30] = kf29*y_data[37];
kf_rates[31] = kf29*y_data[21];
kf_rates[32] = kf31*y_data[6]*y_data[23];
kr_rates[9] = kr31*y_data[24];
kf_rates[33] = kf31*y_data[16]*y_data[23];
kr_rates[10] = kr31*y_data[25];
kf_rates[34] = kf33*y_data[12]*y_data[23];
kr_rates[11] = kr33*y_data[26];
kf_rates[35] = kf33*y_data[20]*y_data[23];
kr_rates[12] = kr33*y_data[27];
kf_rates[36] = kf35*y_data[24];
kf_rates[37] = kf35*y_data[25];
kf_rates[38] = kf37*y_data[26];
kf_rates[39] = kf37*y_data[27];
kf_rates[40] = kf39*y_data[6]*y_data[30];
kr_rates[13] = kr39*y_data[31];
kf_rates[41] = kf39*y_data[16]*y_data[30];
kr_rates[14] = kr39*y_data[32];
kf_rates[42] = kf41*y_data[6]*y_data[33];
kr_rates[15] = kr41*y_data[34];
kf_rates[43] = kf41*y_data[16]*y_data[33];
kr_rates[16] = kr41*y_data[35];
kf_rates[44] = kf43*y_data[12]*y_data[30];
kr_rates[17] = kr43*y_data[36];
kf_rates[45] = kf43*y_data[20]*y_data[30];
kr_rates[18] = kr43*y_data[37];
kf_rates[46] = kf45*y_data[6]*y_data[38];
kr_rates[19] = kr45*y_data[31]*y_data[39];
kf_rates[47] = kf45*y_data[16]*y_data[38];
kr_rates[20] = kr45*y_data[32]*y_data[39];
kf_rates[48] = kf47*y_data[6]*y_data[40];
kr_rates[21] = kr47*y_data[34]*y_data[39];
kf_rates[49] = kf47*y_data[16]*y_data[40];
kr_rates[22] = kr47*y_data[35]*y_data[39];
kf_rates[50] = kf49*y_data[12]*y_data[38];
kr_rates[23] = kr49*y_data[36]*y_data[39];
kf_rates[51] = kf49*y_data[20]*y_data[38];
kr_rates[24] = kr49*y_data[37]*y_data[39];
kf_rates[52] = kf51*y_data[31];
kf_rates[53] = kf51*y_data[32];
kf_rates[54] = kf51*y_data[34];
kf_rates[55] = kf51*y_data[35];
kf_rates[56] = kf55*y_data[36];
kf_rates[57] = kf55*y_data[37];
kf_rates[58] = kf57*y_data[28];
kf_rates[59] = kf58*y_data[29];
kf_rates[60] = kf59*y_data[41];
kf_rates[61] = kf60*y_data[42];
kf_rates[62] = kf61*y_data[43];
kf_rates[63] = kf62*y_data[41]*y_data[44];
kr_rates[25] = kr62*y_data[45];
kf_rates[64] = kf62*y_data[42]*y_data[44];
kr_rates[26] = kr62*y_data[46];
kf_rates[65] = kf62*y_data[43]*y_data[44];
kr_rates[27] = kr62*y_data[47];
kf_rates[66] = kf65_M*y_data[45];
kf_rates[67] = kf65_M*y_data[46];
kf_rates[68] = kf65_E*y_data[47];
kf_rates[69] = kf68*y_data[48];
kf_rates[70] = kf69*y_data[41]*y_data[49];
kr_rates[28] = kr69*y_data[50];
kf_rates[71] = kf69*y_data[42]*y_data[49];
kr_rates[29] = kr69*y_data[51];
kf_rates[72] = kf69*y_data[43]*y_data[49];
kr_rates[30] = kr69*y_data[52];
kf_rates[73] = kf72_M*y_data[50];
kf_rates[74] = kf72_M*y_data[51];
kf_rates[75] = kf72_E*y_data[52];
kf_rates[76] = kf75*y_data[53];
kf_rates[77] = kf76_M*y_data[41]*y_data[54];
kr_rates[31] = kr76*y_data[55];
kf_rates[78] = kf76_M*y_data[42]*y_data[54];
kr_rates[32] = kr76*y_data[56];
kf_rates[79] = kf76_E*y_data[43]*y_data[54];
kr_rates[33] = kr76*y_data[57];
kf_rates[80] = kf79*y_data[55];
kf_rates[81] = kf79*y_data[56];
kf_rates[82] = kf79*y_data[57];
kf_rates[83] = kf82*y_data[58];
kf_rates[84] = kf83_M*y_data[28]*y_data[59];
kr_rates[34] = kr83*y_data[60];
kf_rates[85] = kf83_E*y_data[29]*y_data[59];
kr_rates[35] = kr83*y_data[61];
kf_rates[86] = kf85_M*y_data[60];
kf_rates[87] = kf85_E*y_data[61];
kf_rates[88] = kf87*y_data[48]*y_data[53];
kr_rates[36] = kr87*y_data[63];
kf_rates[89] = kf88*y_data[63];
kf_rates[90] = kf89*y_data[48]*y_data[62];
kr_rates[37] = kr89*y_data[64];
kf_rates[91] = kf90*y_data[64];
kf_rates[92] = kf91*y_data[62]*y_data[74];
kr_rates[38] = kr91*y_data[75];
kf_rates[93] = kf92*y_data[75];
kf_rates[94] = kf93*y_data[76]*y_data[77];
kr_rates[39] = kr93*y_data[78];
kf_rates[95] = kf94*y_data[78];
kf_rates[96] = kf95*y_data[76]*y_data[79];
kr_rates[40] = kr95*y_data[80];
kf_rates[97] = kf96*y_data[80];
kf_rates[98] = kf97*y_data[81]*y_data[65];
kr_rates[41] = kr97*y_data[82];
kf_rates[99] = kf98*y_data[82];
kf_rates[100] = kf99*y_data[81]*y_data[83];
kr_rates[42] = kr99*y_data[84];
kf_rates[101] = kf100*y_data[84];
kf_rates[102] = kf101*y_data[76];
kf_rates[103] = kf102*y_data[81];
kf_rates[104] = kf103*y_data[79];
kf_rates[105] = kf107*y_data[66]*y_data[67];
kr_rates[43] = kr107*y_data[68];
kf_rates[106] = kf108*y_data[68];
kf_rates[107] = kf111*y_data[66]*y_data[23];
kr_rates[44] = kr111*y_data[69];
kf_rates[108] = kf112*y_data[69];
kf_rates[109] = kf113*y_data[66]*y_data[30];
kr_rates[45] = kr113*y_data[71];
kf_rates[110] = kf114*y_data[71];
kf_rates[111] = kf115*y_data[70];
kf_rates[112] = kf116*y_data[33];
kf_rates[113] = kf117*y_data[58]*y_data[72];
kr_rates[46] = kr117*y_data[73];
kf_rates[114] = kf118*y_data[73];
kf_rates[115] = kf119*y_data[39];
kf_rates[116] = kf120*y_data[39]*y_data[30];
kr_rates[47] = kr120*y_data[38];
kf_rates[117] = kf121*y_data[39]*y_data[33];
kr_rates[48] = kr121*y_data[40];
kf_rates[118] = kf122*y_data[4];
kr_rates[49] = kr122*y_data[14];
kf_rates[119] = kf122*y_data[5];
kr_rates[50] = kr122*y_data[15];
kf_rates[120] = kf124*y_data[6];
kr_rates[51] = kr124*y_data[16];
kf_rates[121] = kf124*y_data[24];
kr_rates[52] = kr124*y_data[25];
kf_rates[122] = kf124*y_data[8];
kr_rates[53] = kr124*y_data[17];
kf_rates[123] = kf126*y_data[10];
kr_rates[54] = kr126*y_data[18];
kf_rates[124] = kf126*y_data[11];
kr_rates[55] = kr126*y_data[19];
kf_rates[125] = kf128*y_data[12];
kr_rates[56] = kr128*y_data[20];
kf_rates[126] = kf128*y_data[26];
kr_rates[57] = kr128*y_data[27];
kf_rates[127] = kf128*y_data[36];
kr_rates[58] = kr128*y_data[37];
kf_rates[128] = kf128*y_data[13];
kr_rates[59] = kr128*y_data[21];

}

static int f(realtype t, N_Vector y, N_Vector ydot, void *user_data)
{
	UserData* data;
	data = (UserData*) user_data;

	realtype kf_rates[129], kr_rates[60];
	realtype *ydot_data = NV_DATA_S(ydot);

	setRates(kf_rates, kr_rates, y, data);

ydot_data[0] = 0;
ydot_data[1] =  + kf_rates[0] - kf_rates[7] + kr_rates[3];
ydot_data[2] =  + kf_rates[1] - kf_rates[2] + kr_rates[0];
ydot_data[3] = 0;
ydot_data[4] =  + kf_rates[2] - kr_rates[0] - kf_rates[3] - kf_rates[3] + kr_rates[1] + kr_rates[1] - kf_rates[118] + kr_rates[49];
ydot_data[5] =  + kf_rates[3] - kr_rates[1] - kf_rates[4] + kf_rates[6] - kf_rates[119] + kr_rates[50];
ydot_data[6] =  + kf_rates[4] - kf_rates[5] + kr_rates[2] - kf_rates[32] + kr_rates[9] + kf_rates[36] - kf_rates[40] + kr_rates[13] - kf_rates[42] + kr_rates[15] - kf_rates[46] + kr_rates[19] - kf_rates[48] + kr_rates[21] + kf_rates[52] + kf_rates[54] - kf_rates[120] + kr_rates[51];
ydot_data[7] =  - kf_rates[5] + kr_rates[2] + kf_rates[6] - kf_rates[10] + kr_rates[5] + kf_rates[11] - kf_rates[14] + kr_rates[7] + kf_rates[15] - kf_rates[18] + kf_rates[19];
ydot_data[8] =  + kf_rates[5] - kr_rates[2] - kf_rates[6] - kf_rates[122] + kr_rates[53];
ydot_data[9] = 0;
ydot_data[10] =  + kf_rates[7] - kr_rates[3] - kf_rates[8] - kf_rates[8] + kr_rates[4] + kr_rates[4] - kf_rates[123] + kr_rates[54];
ydot_data[11] =  + kf_rates[8] - kr_rates[4] - kf_rates[9] + kf_rates[11] - kf_rates[124] + kr_rates[55];
ydot_data[12] =  + kf_rates[9] - kf_rates[10] + kr_rates[5] - kf_rates[34] + kr_rates[11] + kf_rates[38] - kf_rates[44] + kr_rates[17] - kf_rates[50] + kr_rates[23] + kf_rates[56] - kf_rates[125] + kr_rates[56];
ydot_data[13] =  + kf_rates[10] - kr_rates[5] - kf_rates[11] - kf_rates[128] + kr_rates[59];
ydot_data[14] =  - kf_rates[12] - kf_rates[12] + kr_rates[6] + kr_rates[6] - kf_rates[20] + kf_rates[118] - kr_rates[49];
ydot_data[15] =  + kf_rates[12] - kr_rates[6] - kf_rates[13] + kf_rates[15] - kf_rates[21] + kf_rates[119] - kr_rates[50];
ydot_data[16] =  + kf_rates[13] - kf_rates[14] + kr_rates[7] - kf_rates[22] - kf_rates[33] + kr_rates[10] + kf_rates[37] - kf_rates[41] + kr_rates[14] - kf_rates[43] + kr_rates[16] - kf_rates[47] + kr_rates[20] - kf_rates[49] + kr_rates[22] + kf_rates[53] + kf_rates[55] + kf_rates[120] - kr_rates[51];
ydot_data[17] =  + kf_rates[14] - kr_rates[7] - kf_rates[15] - kf_rates[25] + kf_rates[122] - kr_rates[53];
ydot_data[18] =  - kf_rates[16] - kf_rates[16] + kr_rates[8] + kr_rates[8] - kf_rates[26] + kf_rates[123] - kr_rates[54];
ydot_data[19] =  + kf_rates[16] - kr_rates[8] - kf_rates[17] + kf_rates[19] - kf_rates[27] + kf_rates[124] - kr_rates[55];
ydot_data[20] =  + kf_rates[17] - kf_rates[18] - kf_rates[28] - kf_rates[35] + kr_rates[12] + kf_rates[39] - kf_rates[45] + kr_rates[18] - kf_rates[51] + kr_rates[24] + kf_rates[57] + kf_rates[125] - kr_rates[56];
ydot_data[21] =  + kf_rates[18] - kf_rates[19] - kf_rates[31] + kf_rates[128] - kr_rates[59];
ydot_data[22] =  + kf_rates[20] + kf_rates[21] + kf_rates[22] + kf_rates[23] + kf_rates[24] + kf_rates[25] + kf_rates[26] + kf_rates[27] + kf_rates[28] + kf_rates[29] + kf_rates[30] + kf_rates[31];
ydot_data[23] =  - kf_rates[32] + kr_rates[9] - kf_rates[33] + kr_rates[10] - kf_rates[34] + kr_rates[11] - kf_rates[35] + kr_rates[12] + kf_rates[58] + kf_rates[59] - kf_rates[107] + kr_rates[44] + kf_rates[111];
ydot_data[24] =  + kf_rates[32] - kr_rates[9] - kf_rates[36] - kf_rates[121] + kr_rates[52];
ydot_data[25] =  - kf_rates[23] + kf_rates[33] - kr_rates[10] - kf_rates[37] + kf_rates[121] - kr_rates[52];
ydot_data[26] =  + kf_rates[34] - kr_rates[11] - kf_rates[38] - kf_rates[126] + kr_rates[57];
ydot_data[27] =  - kf_rates[29] + kf_rates[35] - kr_rates[12] - kf_rates[39] + kf_rates[126] - kr_rates[57];
ydot_data[28] =  + kf_rates[36] + kf_rates[37] - kf_rates[58] - kf_rates[84] + kr_rates[34] + kf_rates[86];
ydot_data[29] =  + kf_rates[38] + kf_rates[39] - kf_rates[59] - kf_rates[85] + kr_rates[35] + kf_rates[87];
ydot_data[30] =  - kf_rates[40] + kr_rates[13] - kf_rates[41] + kr_rates[14] - kf_rates[44] + kr_rates[17] - kf_rates[45] + kr_rates[18] + kf_rates[60] + kf_rates[62] - kf_rates[109] + kr_rates[45] + kf_rates[112] - kf_rates[116] + kr_rates[47];
ydot_data[31] =  + kf_rates[40] - kr_rates[13] + kf_rates[46] - kr_rates[19] - kf_rates[52];
ydot_data[32] =  - kf_rates[24] + kf_rates[41] - kr_rates[14] + kf_rates[47] - kr_rates[20] - kf_rates[53];
ydot_data[33] =  - kf_rates[42] + kr_rates[15] - kf_rates[43] + kr_rates[16] + kf_rates[61] + kf_rates[110] - kf_rates[112] - kf_rates[117] + kr_rates[48];
ydot_data[34] =  + kf_rates[42] - kr_rates[15] + kf_rates[48] - kr_rates[21] - kf_rates[54];
ydot_data[35] =  + kf_rates[43] - kr_rates[16] + kf_rates[49] - kr_rates[22] - kf_rates[55];
ydot_data[36] =  + kf_rates[44] - kr_rates[17] + kf_rates[50] - kr_rates[23] - kf_rates[56] - kf_rates[127] + kr_rates[58];
ydot_data[37] =  - kf_rates[30] + kf_rates[45] - kr_rates[18] + kf_rates[51] - kr_rates[24] - kf_rates[57] + kf_rates[127] - kr_rates[58];
ydot_data[38] =  - kf_rates[46] + kr_rates[19] - kf_rates[47] + kr_rates[20] - kf_rates[50] + kr_rates[23] - kf_rates[51] + kr_rates[24] + kf_rates[116] - kr_rates[47];
ydot_data[39] =  + kf_rates[46] - kr_rates[19] + kf_rates[47] - kr_rates[20] + kf_rates[48] - kr_rates[21] + kf_rates[49] - kr_rates[22] + kf_rates[50] - kr_rates[23] + kf_rates[51] - kr_rates[24] + kf_rates[114] - kf_rates[115] - kf_rates[116] + kr_rates[47] - kf_rates[117] + kr_rates[48];
ydot_data[40] =  - kf_rates[48] + kr_rates[21] - kf_rates[49] + kr_rates[22] + kf_rates[117] - kr_rates[48];
ydot_data[41] =  + kf_rates[52] + kf_rates[53] - kf_rates[60] - kf_rates[63] + kr_rates[25] + kf_rates[66] - kf_rates[70] + kr_rates[28] + kf_rates[73] - kf_rates[77] + kr_rates[31] + kf_rates[80];
ydot_data[42] =  + kf_rates[54] + kf_rates[55] - kf_rates[61] - kf_rates[64] + kr_rates[26] + kf_rates[67] - kf_rates[71] + kr_rates[29] + kf_rates[74] - kf_rates[78] + kr_rates[32] + kf_rates[81];
ydot_data[43] =  + kf_rates[56] + kf_rates[57] - kf_rates[62] - kf_rates[65] + kr_rates[27] + kf_rates[68] - kf_rates[72] + kr_rates[30] + kf_rates[75] - kf_rates[79] + kr_rates[33] + kf_rates[82];
ydot_data[44] =  - kf_rates[63] + kr_rates[25] - kf_rates[64] + kr_rates[26] - kf_rates[65] + kr_rates[27] + kf_rates[69] + kf_rates[89];
ydot_data[45] =  + kf_rates[63] - kr_rates[25] - kf_rates[66];
ydot_data[46] =  + kf_rates[64] - kr_rates[26] - kf_rates[67];
ydot_data[47] =  + kf_rates[65] - kr_rates[27] - kf_rates[68];
ydot_data[48] =  + kf_rates[66] + kf_rates[67] + kf_rates[68] - kf_rates[69] - kf_rates[88] + kr_rates[36] - kf_rates[90] + kr_rates[37] + kf_rates[91];
ydot_data[49] =  - kf_rates[70] + kr_rates[28] - kf_rates[71] + kr_rates[29] - kf_rates[72] + kr_rates[30] + kf_rates[76];
ydot_data[50] =  + kf_rates[70] - kr_rates[28] - kf_rates[73];
ydot_data[51] =  + kf_rates[71] - kr_rates[29] - kf_rates[74];
ydot_data[52] =  + kf_rates[72] - kr_rates[30] - kf_rates[75];
ydot_data[53] =  + kf_rates[73] + kf_rates[74] + kf_rates[75] - kf_rates[76] - kf_rates[88] + kr_rates[36] + kf_rates[89];
ydot_data[54] =  - kf_rates[77] + kr_rates[31] - kf_rates[78] + kr_rates[32] - kf_rates[79] + kr_rates[33] + kf_rates[83];
ydot_data[55] =  + kf_rates[77] - kr_rates[31] - kf_rates[80];
ydot_data[56] =  + kf_rates[78] - kr_rates[32] - kf_rates[81];
ydot_data[57] =  + kf_rates[79] - kr_rates[33] - kf_rates[82];
ydot_data[58] =  + kf_rates[80] + kf_rates[81] + kf_rates[82] - kf_rates[83] - kf_rates[113] + kr_rates[46] + kf_rates[114];
ydot_data[59] =  - kf_rates[84] + kr_rates[34] - kf_rates[85] + kr_rates[35] + kf_rates[91];
ydot_data[60] =  + kf_rates[84] - kr_rates[34] - kf_rates[86];
ydot_data[61] =  + kf_rates[85] - kr_rates[35] - kf_rates[87];
ydot_data[62] =  + kf_rates[86] + kf_rates[87] - kf_rates[90] + kr_rates[37] - kf_rates[92] + kr_rates[38] + kf_rates[93];
ydot_data[63] =  + kf_rates[88] - kr_rates[36] - kf_rates[89];
ydot_data[64] =  + kf_rates[90] - kr_rates[37] - kf_rates[91];
ydot_data[65] =  - kf_rates[98] + kr_rates[41] + kf_rates[106];
ydot_data[66] =  + kf_rates[101] - kf_rates[105] + kr_rates[43] - kf_rates[107] + kr_rates[44] + kf_rates[108] - kf_rates[109] + kr_rates[45] + kf_rates[110];
ydot_data[67] =  - kf_rates[105] + kr_rates[43] + kf_rates[106];
ydot_data[68] =  + kf_rates[105] - kr_rates[43] - kf_rates[106];
ydot_data[69] =  + kf_rates[107] - kr_rates[44] - kf_rates[108];
ydot_data[70] =  + kf_rates[108] - kf_rates[111];
ydot_data[71] =  + kf_rates[109] - kr_rates[45] - kf_rates[110];
ydot_data[72] =  - kf_rates[113] + kr_rates[46] + kf_rates[115];
ydot_data[73] =  + kf_rates[113] - kr_rates[46] - kf_rates[114];
ydot_data[74] =  - kf_rates[92] + kr_rates[38] + kf_rates[102];
ydot_data[75] =  + kf_rates[92] - kr_rates[38] - kf_rates[93];
ydot_data[76] =  + kf_rates[93] - kf_rates[94] + kr_rates[39] + kf_rates[95] - kf_rates[96] + kr_rates[40] + kf_rates[97] - kf_rates[102];
ydot_data[77] =  - kf_rates[94] + kr_rates[39] + kf_rates[104];
ydot_data[78] =  + kf_rates[94] - kr_rates[39] - kf_rates[95];
ydot_data[79] =  + kf_rates[95] - kf_rates[96] + kr_rates[40] + kf_rates[103] - kf_rates[104];
ydot_data[80] =  + kf_rates[96] - kr_rates[40] - kf_rates[97];
ydot_data[81] =  + kf_rates[97] - kf_rates[98] + kr_rates[41] + kf_rates[99] - kf_rates[100] + kr_rates[42] + kf_rates[101] - kf_rates[103];
ydot_data[82] =  + kf_rates[98] - kr_rates[41] - kf_rates[99];
ydot_data[83] =  + kf_rates[99] - kf_rates[100] + kr_rates[42];
ydot_data[84] =  + kf_rates[100] - kr_rates[42] - kf_rates[101];

return(0);
}

static int jtv(N_Vector v, N_Vector Jv, realtype t,
               N_Vector y, N_Vector fy,
               void *user_data, N_Vector tmp)
{	
	UserData* data;
	data = (UserData*) user_data;
		
	updateJac(data,y);
			
	realtype *Jv_data =  NV_DATA_S(Jv);
	realtype *v_data  =  NV_DATA_S(v);
	realtype *spJ = &(data->spJ[0]);

Jv_data[0] = 0;
Jv_data[1] = + spJ[0]*v_data[0] + spJ[1]*v_data[1] + spJ[2]*v_data[9] + spJ[3]*v_data[10] ;
Jv_data[2] = + spJ[4]*v_data[0] + spJ[5]*v_data[2] + spJ[6]*v_data[3] + spJ[7]*v_data[4] ;
Jv_data[3] = 0;
Jv_data[4] = + spJ[8]*v_data[2] + spJ[9]*v_data[3] + spJ[10]*v_data[4] + spJ[11]*v_data[5] + spJ[12]*v_data[14] ;
Jv_data[5] = + spJ[13]*v_data[4] + spJ[14]*v_data[5] + spJ[15]*v_data[8] + spJ[16]*v_data[15] ;
Jv_data[6] = + spJ[17]*v_data[5] + spJ[18]*v_data[6] + spJ[19]*v_data[7] + spJ[20]*v_data[8] + spJ[21]*v_data[16] + spJ[22]*v_data[23] + spJ[23]*v_data[24] + spJ[24]*v_data[30] + spJ[25]*v_data[31] + spJ[26]*v_data[33] + spJ[27]*v_data[34] + spJ[28]*v_data[38] + spJ[29]*v_data[39] + spJ[30]*v_data[40] ;
Jv_data[7] = + spJ[31]*v_data[6] + spJ[32]*v_data[7] + spJ[33]*v_data[8] + spJ[34]*v_data[12] + spJ[35]*v_data[13] + spJ[36]*v_data[16] + spJ[37]*v_data[17] + spJ[38]*v_data[20] + spJ[39]*v_data[21] ;
Jv_data[8] = + spJ[40]*v_data[6] + spJ[41]*v_data[7] + spJ[42]*v_data[8] + spJ[43]*v_data[17] ;
Jv_data[9] = 0;
Jv_data[10] = + spJ[44]*v_data[1] + spJ[45]*v_data[9] + spJ[46]*v_data[10] + spJ[47]*v_data[11] + spJ[48]*v_data[18] ;
Jv_data[11] = + spJ[49]*v_data[10] + spJ[50]*v_data[11] + spJ[51]*v_data[13] + spJ[52]*v_data[19] ;
Jv_data[12] = + spJ[53]*v_data[7] + spJ[54]*v_data[11] + spJ[55]*v_data[12] + spJ[56]*v_data[13] + spJ[57]*v_data[20] + spJ[58]*v_data[23] + spJ[59]*v_data[26] + spJ[60]*v_data[30] + spJ[61]*v_data[36] + spJ[62]*v_data[38] + spJ[63]*v_data[39] ;
Jv_data[13] = + spJ[64]*v_data[7] + spJ[65]*v_data[12] + spJ[66]*v_data[13] + spJ[67]*v_data[21] ;
Jv_data[14] = + spJ[68]*v_data[4] + spJ[69]*v_data[14] + spJ[70]*v_data[15] ;
Jv_data[15] = + spJ[71]*v_data[5] + spJ[72]*v_data[14] + spJ[73]*v_data[15] + spJ[74]*v_data[17] ;
Jv_data[16] = + spJ[75]*v_data[6] + spJ[76]*v_data[7] + spJ[77]*v_data[15] + spJ[78]*v_data[16] + spJ[79]*v_data[17] + spJ[80]*v_data[23] + spJ[81]*v_data[25] + spJ[82]*v_data[30] + spJ[83]*v_data[32] + spJ[84]*v_data[33] + spJ[85]*v_data[35] + spJ[86]*v_data[38] + spJ[87]*v_data[39] + spJ[88]*v_data[40] ;
Jv_data[17] = + spJ[89]*v_data[7] + spJ[90]*v_data[8] + spJ[91]*v_data[16] + spJ[92]*v_data[17] ;
Jv_data[18] = + spJ[93]*v_data[10] + spJ[94]*v_data[18] + spJ[95]*v_data[19] ;
Jv_data[19] = + spJ[96]*v_data[11] + spJ[97]*v_data[18] + spJ[98]*v_data[19] + spJ[99]*v_data[21] ;
Jv_data[20] = + spJ[100]*v_data[7] + spJ[101]*v_data[12] + spJ[102]*v_data[19] + spJ[103]*v_data[20] + spJ[104]*v_data[23] + spJ[105]*v_data[27] + spJ[106]*v_data[30] + spJ[107]*v_data[37] + spJ[108]*v_data[38] + spJ[109]*v_data[39] ;
Jv_data[21] = + spJ[110]*v_data[7] + spJ[111]*v_data[13] + spJ[112]*v_data[20] + spJ[113]*v_data[21] ;
Jv_data[22] = + spJ[114]*v_data[14] + spJ[115]*v_data[15] + spJ[116]*v_data[16] + spJ[117]*v_data[17] + spJ[118]*v_data[18] + spJ[119]*v_data[19] + spJ[120]*v_data[20] + spJ[121]*v_data[21] + spJ[122]*v_data[25] + spJ[123]*v_data[27] + spJ[124]*v_data[32] + spJ[125]*v_data[37] ;
Jv_data[23] = + spJ[126]*v_data[6] + spJ[127]*v_data[12] + spJ[128]*v_data[16] + spJ[129]*v_data[20] + spJ[130]*v_data[23] + spJ[131]*v_data[24] + spJ[132]*v_data[25] + spJ[133]*v_data[26] + spJ[134]*v_data[27] + spJ[135]*v_data[28] + spJ[136]*v_data[29] + spJ[137]*v_data[66] + spJ[138]*v_data[69] + spJ[139]*v_data[70] ;
Jv_data[24] = + spJ[140]*v_data[6] + spJ[141]*v_data[23] + spJ[142]*v_data[24] + spJ[143]*v_data[25] ;
Jv_data[25] = + spJ[144]*v_data[16] + spJ[145]*v_data[23] + spJ[146]*v_data[24] + spJ[147]*v_data[25] ;
Jv_data[26] = + spJ[148]*v_data[12] + spJ[149]*v_data[23] + spJ[150]*v_data[26] + spJ[151]*v_data[27] ;
Jv_data[27] = + spJ[152]*v_data[20] + spJ[153]*v_data[23] + spJ[154]*v_data[26] + spJ[155]*v_data[27] ;
Jv_data[28] = + spJ[156]*v_data[24] + spJ[157]*v_data[25] + spJ[158]*v_data[28] + spJ[159]*v_data[59] + spJ[160]*v_data[60] ;
Jv_data[29] = + spJ[161]*v_data[26] + spJ[162]*v_data[27] + spJ[163]*v_data[29] + spJ[164]*v_data[59] + spJ[165]*v_data[61] ;
Jv_data[30] = + spJ[166]*v_data[6] + spJ[167]*v_data[12] + spJ[168]*v_data[16] + spJ[169]*v_data[20] + spJ[170]*v_data[30] + spJ[171]*v_data[31] + spJ[172]*v_data[32] + spJ[173]*v_data[33] + spJ[174]*v_data[36] + spJ[175]*v_data[37] + spJ[176]*v_data[38] + spJ[177]*v_data[39] + spJ[178]*v_data[41] + spJ[179]*v_data[43] + spJ[180]*v_data[66] + spJ[181]*v_data[71] ;
Jv_data[31] = + spJ[182]*v_data[6] + spJ[183]*v_data[30] + spJ[184]*v_data[31] + spJ[185]*v_data[38] + spJ[186]*v_data[39] ;
Jv_data[32] = + spJ[187]*v_data[16] + spJ[188]*v_data[30] + spJ[189]*v_data[32] + spJ[190]*v_data[38] + spJ[191]*v_data[39] ;
Jv_data[33] = + spJ[192]*v_data[6] + spJ[193]*v_data[16] + spJ[194]*v_data[33] + spJ[195]*v_data[34] + spJ[196]*v_data[35] + spJ[197]*v_data[39] + spJ[198]*v_data[40] + spJ[199]*v_data[42] + spJ[200]*v_data[71] ;
Jv_data[34] = + spJ[201]*v_data[6] + spJ[202]*v_data[33] + spJ[203]*v_data[34] + spJ[204]*v_data[39] + spJ[205]*v_data[40] ;
Jv_data[35] = + spJ[206]*v_data[16] + spJ[207]*v_data[33] + spJ[208]*v_data[35] + spJ[209]*v_data[39] + spJ[210]*v_data[40] ;
Jv_data[36] = + spJ[211]*v_data[12] + spJ[212]*v_data[30] + spJ[213]*v_data[36] + spJ[214]*v_data[37] + spJ[215]*v_data[38] + spJ[216]*v_data[39] ;
Jv_data[37] = + spJ[217]*v_data[20] + spJ[218]*v_data[30] + spJ[219]*v_data[36] + spJ[220]*v_data[37] + spJ[221]*v_data[38] + spJ[222]*v_data[39] ;
Jv_data[38] = + spJ[223]*v_data[6] + spJ[224]*v_data[12] + spJ[225]*v_data[16] + spJ[226]*v_data[20] + spJ[227]*v_data[30] + spJ[228]*v_data[31] + spJ[229]*v_data[32] + spJ[230]*v_data[36] + spJ[231]*v_data[37] + spJ[232]*v_data[38] + spJ[233]*v_data[39] ;
Jv_data[39] = + spJ[234]*v_data[6] + spJ[235]*v_data[12] + spJ[236]*v_data[16] + spJ[237]*v_data[20] + spJ[238]*v_data[30] + spJ[239]*v_data[31] + spJ[240]*v_data[32] + spJ[241]*v_data[33] + spJ[242]*v_data[34] + spJ[243]*v_data[35] + spJ[244]*v_data[36] + spJ[245]*v_data[37] + spJ[246]*v_data[38] + spJ[247]*v_data[39] + spJ[248]*v_data[40] + spJ[249]*v_data[73] ;
Jv_data[40] = + spJ[250]*v_data[6] + spJ[251]*v_data[16] + spJ[252]*v_data[33] + spJ[253]*v_data[34] + spJ[254]*v_data[35] + spJ[255]*v_data[39] + spJ[256]*v_data[40] ;
Jv_data[41] = + spJ[257]*v_data[31] + spJ[258]*v_data[32] + spJ[259]*v_data[41] + spJ[260]*v_data[44] + spJ[261]*v_data[45] + spJ[262]*v_data[49] + spJ[263]*v_data[50] + spJ[264]*v_data[54] + spJ[265]*v_data[55] ;
Jv_data[42] = + spJ[266]*v_data[34] + spJ[267]*v_data[35] + spJ[268]*v_data[42] + spJ[269]*v_data[44] + spJ[270]*v_data[46] + spJ[271]*v_data[49] + spJ[272]*v_data[51] + spJ[273]*v_data[54] + spJ[274]*v_data[56] ;
Jv_data[43] = + spJ[275]*v_data[36] + spJ[276]*v_data[37] + spJ[277]*v_data[43] + spJ[278]*v_data[44] + spJ[279]*v_data[47] + spJ[280]*v_data[49] + spJ[281]*v_data[52] + spJ[282]*v_data[54] + spJ[283]*v_data[57] ;
Jv_data[44] = + spJ[284]*v_data[41] + spJ[285]*v_data[42] + spJ[286]*v_data[43] + spJ[287]*v_data[44] + spJ[288]*v_data[45] + spJ[289]*v_data[46] + spJ[290]*v_data[47] + spJ[291]*v_data[48] + spJ[292]*v_data[63] ;
Jv_data[45] = + spJ[293]*v_data[41] + spJ[294]*v_data[44] + spJ[295]*v_data[45] ;
Jv_data[46] = + spJ[296]*v_data[42] + spJ[297]*v_data[44] + spJ[298]*v_data[46] ;
Jv_data[47] = + spJ[299]*v_data[43] + spJ[300]*v_data[44] + spJ[301]*v_data[47] ;
Jv_data[48] = + spJ[302]*v_data[45] + spJ[303]*v_data[46] + spJ[304]*v_data[47] + spJ[305]*v_data[48] + spJ[306]*v_data[53] + spJ[307]*v_data[62] + spJ[308]*v_data[63] + spJ[309]*v_data[64] ;
Jv_data[49] = + spJ[310]*v_data[41] + spJ[311]*v_data[42] + spJ[312]*v_data[43] + spJ[313]*v_data[49] + spJ[314]*v_data[50] + spJ[315]*v_data[51] + spJ[316]*v_data[52] + spJ[317]*v_data[53] ;
Jv_data[50] = + spJ[318]*v_data[41] + spJ[319]*v_data[49] + spJ[320]*v_data[50] ;
Jv_data[51] = + spJ[321]*v_data[42] + spJ[322]*v_data[49] + spJ[323]*v_data[51] ;
Jv_data[52] = + spJ[324]*v_data[43] + spJ[325]*v_data[49] + spJ[326]*v_data[52] ;
Jv_data[53] = + spJ[327]*v_data[48] + spJ[328]*v_data[50] + spJ[329]*v_data[51] + spJ[330]*v_data[52] + spJ[331]*v_data[53] + spJ[332]*v_data[63] ;
Jv_data[54] = + spJ[333]*v_data[41] + spJ[334]*v_data[42] + spJ[335]*v_data[43] + spJ[336]*v_data[54] + spJ[337]*v_data[55] + spJ[338]*v_data[56] + spJ[339]*v_data[57] + spJ[340]*v_data[58] ;
Jv_data[55] = + spJ[341]*v_data[41] + spJ[342]*v_data[54] + spJ[343]*v_data[55] ;
Jv_data[56] = + spJ[344]*v_data[42] + spJ[345]*v_data[54] + spJ[346]*v_data[56] ;
Jv_data[57] = + spJ[347]*v_data[43] + spJ[348]*v_data[54] + spJ[349]*v_data[57] ;
Jv_data[58] = + spJ[350]*v_data[55] + spJ[351]*v_data[56] + spJ[352]*v_data[57] + spJ[353]*v_data[58] + spJ[354]*v_data[72] + spJ[355]*v_data[73] ;
Jv_data[59] = + spJ[356]*v_data[28] + spJ[357]*v_data[29] + spJ[358]*v_data[59] + spJ[359]*v_data[60] + spJ[360]*v_data[61] + spJ[361]*v_data[64] ;
Jv_data[60] = + spJ[362]*v_data[28] + spJ[363]*v_data[59] + spJ[364]*v_data[60] ;
Jv_data[61] = + spJ[365]*v_data[29] + spJ[366]*v_data[59] + spJ[367]*v_data[61] ;
Jv_data[62] = + spJ[368]*v_data[48] + spJ[369]*v_data[60] + spJ[370]*v_data[61] + spJ[371]*v_data[62] + spJ[372]*v_data[64] + spJ[373]*v_data[74] + spJ[374]*v_data[75] ;
Jv_data[63] = + spJ[375]*v_data[48] + spJ[376]*v_data[53] + spJ[377]*v_data[63] ;
Jv_data[64] = + spJ[378]*v_data[48] + spJ[379]*v_data[62] + spJ[380]*v_data[64] ;
Jv_data[65] = + spJ[381]*v_data[65] + spJ[382]*v_data[68] + spJ[383]*v_data[81] + spJ[384]*v_data[82] ;
Jv_data[66] = + spJ[385]*v_data[23] + spJ[386]*v_data[30] + spJ[387]*v_data[66] + spJ[388]*v_data[67] + spJ[389]*v_data[68] + spJ[390]*v_data[69] + spJ[391]*v_data[71] + spJ[392]*v_data[84] ;
Jv_data[67] = + spJ[393]*v_data[66] + spJ[394]*v_data[67] + spJ[395]*v_data[68] ;
Jv_data[68] = + spJ[396]*v_data[66] + spJ[397]*v_data[67] + spJ[398]*v_data[68] ;
Jv_data[69] = + spJ[399]*v_data[23] + spJ[400]*v_data[66] + spJ[401]*v_data[69] ;
Jv_data[70] = + spJ[402]*v_data[69] + spJ[403]*v_data[70] ;
Jv_data[71] = + spJ[404]*v_data[30] + spJ[405]*v_data[66] + spJ[406]*v_data[71] ;
Jv_data[72] = + spJ[407]*v_data[39] + spJ[408]*v_data[58] + spJ[409]*v_data[72] + spJ[410]*v_data[73] ;
Jv_data[73] = + spJ[411]*v_data[58] + spJ[412]*v_data[72] + spJ[413]*v_data[73] ;
Jv_data[74] = + spJ[414]*v_data[62] + spJ[415]*v_data[74] + spJ[416]*v_data[75] + spJ[417]*v_data[76] ;
Jv_data[75] = + spJ[418]*v_data[62] + spJ[419]*v_data[74] + spJ[420]*v_data[75] ;
Jv_data[76] = + spJ[421]*v_data[75] + spJ[422]*v_data[76] + spJ[423]*v_data[77] + spJ[424]*v_data[78] + spJ[425]*v_data[79] + spJ[426]*v_data[80] ;
Jv_data[77] = + spJ[427]*v_data[76] + spJ[428]*v_data[77] + spJ[429]*v_data[78] + spJ[430]*v_data[79] ;
Jv_data[78] = + spJ[431]*v_data[76] + spJ[432]*v_data[77] + spJ[433]*v_data[78] ;
Jv_data[79] = + spJ[434]*v_data[76] + spJ[435]*v_data[78] + spJ[436]*v_data[79] + spJ[437]*v_data[80] + spJ[438]*v_data[81] ;
Jv_data[80] = + spJ[439]*v_data[76] + spJ[440]*v_data[79] + spJ[441]*v_data[80] ;
Jv_data[81] = + spJ[442]*v_data[65] + spJ[443]*v_data[80] + spJ[444]*v_data[81] + spJ[445]*v_data[82] + spJ[446]*v_data[83] + spJ[447]*v_data[84] ;
Jv_data[82] = + spJ[448]*v_data[65] + spJ[449]*v_data[81] + spJ[450]*v_data[82] ;
Jv_data[83] = + spJ[451]*v_data[81] + spJ[452]*v_data[82] + spJ[453]*v_data[83] + spJ[454]*v_data[84] ;
Jv_data[84] = + spJ[455]*v_data[81] + spJ[456]*v_data[83] + spJ[457]*v_data[84] ;

return(0);

}

static int Precond(realtype tn, N_Vector y, N_Vector fy,
                   booleantype jok, booleantype *jcurPtr, realtype gamma,
                   void *user_data, N_Vector vtemp1, N_Vector vtemp2,
                   N_Vector vtemp3)
{	
	
	UserData* data;
	data = (UserData*) user_data;
	
	updateJac(data,y);
	*jcurPtr = TRUE;
static const int valid_ind[81] = {1,2,4,5,6,7,8,10,11,12,13,14,15,16,17,18,19,20,21,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84};
static const int sp_diag_ind[81] = {1,5,10,14,18,32,42,46,50,55,66,69,73,78,92,94,98,103,113,130,142,147,150,155,158,163,170,184,189,194,203,208,213,220,232,247,256,259,268,277,287,295,298,301,305,313,320,323,326,331,336,343,346,349,353,358,364,367,371,377,380,381,387,394,398,401,403,406,409,413,415,420,422,428,433,436,441,444,450,453,457};
realtype *spJ = &(data->spJ[0]);
	
	N_VConst(0,data->J_diag);
	realtype *diag_data = NV_DATA_S(data->J_diag);

	int iter;

	for (iter = 0; iter<81;iter++) {
		diag_data[valid_ind[iter]] = spJ[sp_diag_ind[iter]];
	}
	
	N_VConst(1, vtemp1); /* used to ref wtemp*/
	N_VLinearSum(1,vtemp1,-gamma,data->J_diag,data->J_diag);
	N_VInv(data->J_diag, data->J_diag);

	return(0);
	
}

static int PSolve(realtype tn, N_Vector y, N_Vector fu,
                  N_Vector r, N_Vector z,
                 realtype gamma, realtype delta,
                  int lr, void * user_data, N_Vector vtemp)
{	
	UserData* data;
	data = (UserData*) user_data;
	
	N_VProd(r, data->J_diag, z);
	
	return(0);
}

static void ehfun(int err_code, const char *module, const char *function, char *msg, void *eh_data){
        if (err_code == -1) {
                err_code = 0;
        }
}

